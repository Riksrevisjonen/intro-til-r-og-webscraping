---
title: "Introduksjon til R: løsningsforslag"
output: pdf_document
date: "`r format(Sys.Date(), '%e. %B %Y')`"
---

```{r setup, include=FALSE, error = TRUE}
knitr::opts_chunk$set(echo = TRUE)
```

### Oppgave 1: R som kalkulator

```{r}
3.75 * 4
5^2 - 8
(2 + 10) * -3
2*pi * 3
```

For å gange med tallet pi, kan du enten gange ved å skrive ut tallet selv, eller gange med `pi`, som er en innebygget konstant i R, se `?Constants`.

### Oppgave 2: Tilordning

1. Tilordne verdiene `4` til `x` og `3` til `y`
2. Hva blir summen av `x * y`?
3. Hva blir summen av `x ^ y`?
4. Tilordne summen av `x + x ^ y` til `z`. Hva er verdien av `z`?

```{r}
x <- 4
y <- 3
x * y
x ^ y

(z <- x + x ^ y)
```

Merk at det ikke er nødvendig å sette uttrykket `z <- x + x ^ y` i parentes for å lage `z`, men det kan være nyttig for å se resultatet med én gang; vanligvis får du ikke skrevet resultatet av et funksjonskall når du tilordner resultatet til et nytt objekt. Alternativet er å først tilordne resultatet til et nytt objekt `z`, og så skrive innholdet av `z` til konsollen:

```{r}
z <- x + x ^ y
z
```

5. Tilordne verdiene `"14"` til `x` og `22` til `y`
6. Hva blir summen av `x + y`? Kan du gjøre noe med `x` for at uttrykket skal evalueres til en numerisk verdi?

```{r, error = TRUE}
x <- "14"
y <- 22

x + y 
```

Dette skjer fordi `x` er av typen `character`. Vi må derfor konvertere `x` til numerisk:

```{r}
x <- as.numeric(x)
x + y
```

7. Slett objektene `x`, `y` og `z` fra ditt arbeidsmiljø

```{r}
rm(x, y, z)
```

### Oppgave 3: Vektor

1. Lag en vektor `x` med verdier fra 10 til 19.
2. Hvor mange elementer er det i `x`?

```{r} 
x <- 10:19
length(x)
```

Det er `r length(x)` elementer i x. Hvis man ønsker å se den siste eller nest siste verdien i `x`:

```{r}
x[length(x)]
x[(length(x)-1)]
```

19 er siste og 18 er nest siste verdi.

3. Hva er den tredje verdien i `x`?
4. Hva inneholder elementene 5 til 8?.
5. Hva inneholder elementene 2, 3, og 7?

```{r}
x[3]
x[5:8]
x[c(2,3,7)]
```

Bruk funksjonen `c()` for å angi spesifikke rekker av verdier eller enkeltverdier du ønsker å se på.

**Profftips**

I R er det ofte flere veier til målet, og disse kan være nyttige i hvert sitt tilfelle. For å lage en vektor fra 10 til 19, kan vi gjøre dette på flere måter, her er tre av dem:

```{r}
(x <- 10:19)
(x <- seq(10, 19, 1))
(x <- seq_len(10) + 9)
```

Bruk `?seq` for å få mer informasjon om hva funksjonene `seq()` og `seq_len()` kan gjøre.

### Oppgave 4: Se på datasettet USAarrests

1. Last inn datasettet `USArrests` med `data(USArrests)`.
2. Ta en titt på de fem øverste radene.  
3. Ta en titt på de ti øverste radene.
4. Hvilke kolonnenavn har datasettet?
5. Hvilke radnavn har datasettet?

```{r, include = TRUE}
data("USArrests")
head(USArrests, n = 5)
head(USArrests, n = 10)
colnames(USArrests)
rownames(USArrests)
```

### Oppgave 5: Subset 

1. Kjør `?USArrests` eller `help(USArrests)` [kjøres ikke i løsningsforslag]
2. Hva er verdien i rad 1, kolonne 2?
3. Hvilken delstat i rad 3?
4. Hvilken mordrate i denne delstaten?

```{r USArrests, include = TRUE}
USArrests[1,2]
USArrests[3,]
USArrests[3,]$Murder
USArrests[3,'Murder']
```

Delstaten i rad 3 er Arizona. Fra output kan vi også se at mordraten er 8,1. Vi kan også kjøre ut kun denne verdien ved å spesifisere radnummer og kolonnenavn, som vist på to måter her.

5. I hvilke delstater bor 66 prosent av populasjonen i urbane områder?

```{r}
USArrests[USArrests$UrbanPop == 66,] 
```

Delstatene hvor 66 prosent av populasjonen bor i urbane områder er Kansas, Lousiana, Minnesota, Wisconsin.

### Oppgave 6: Lister

1. Lage et listeobjekt `my_list` med elementene `x = 1`, `y = c("R", "er gøy")` og `z = 1:20` (i denne rekkefølgen)
2. Hva inneholder `my_list[2]`? Hva inneholder `my_list[[2]]`? Hva inneholder `my_list[[2]][2]`?
3. Hvorfor gir `my_list[[1]][2]` en feilmelding?

```{r}
my_list <- list(x = 1, y = c("R", "er gøy"), z = 1:20)
my_list[2]
my_list[[2]]
my_list[[2]][2]
my_list[[1]][2]
```

4. Hva er den fjerde verdien i det tredje listeelementet?

```{r}
my_list[[3]][4]
```

Resultatet blir `NA` fordi det bare er ett element i listens første element, mens vi forsøker å hente ut det andre elementet (som ikke finnes og derfor er missing).

### Oppgave 7: Innebygde funksjoner

1. Sjekk ut hjelpesiden til funksjonen `sum`. Hvilke argumenter tar funksjonen? (`?sum`) [kjøres ikke i løsningsforslag]
2. Lag en vektor `x <- c(1:10, NA)`.
3. Hva er summen av `x` ?
4. Hva er gjennomsnittet av `x` ?
5. Hva er standardavviket til `x` ?

```{r}
x <- c(1:10, NA)
sum(x)
```

`sum(x)` gir `NA` fordi den siste verdien i vektoren er `NA`. R må vite hvordan missing-verdier skal håndteres. Hvis vi ser på hjelpfilen til `sum()`, ser vi at argumentet `na.rm` (forkortelse for slett missing), er satt til `FALSE`. Hvis vi endrer dette til `TRUE`, får vi det resultatet vi regnet med.

```{r}
sum(x, na.rm = TRUE)
mean(x, na.rm = TRUE)
sd(x, na.rm = TRUE)
```

### Oppgave 8: Vektoriserte funksjoner

1. Lag en vektor `my_numbers` med 10 tilfeldig heltall fra 0 til 20. Bruk for eksempel `round(runif(n, min, max))`. Set seed 42 før du kjører kommandoen.
2. Hva er resultatet av `log(my_numbers)`?
3. Hva er resultatet av `sum(my_numbers)`?

```{r}
set.seed(42)
my_numbers <- round(runif(10, min = 0, max = 20))
my_numbers
```

`round` runder av tallene til heltall

4. Hva er forskjellen på kommandoene `sum` og `log`?

```{r}
log(my_numbers)
sum(my_numbers)
```

Forskjellen mellom `log()` og `sum()` er at `log()` tar logaritmen til hvert tall (den er vektorisert), mens `sum()` summerer alle elementene i vektoren. Hvorvidt en funksjon er vektorisert eller ikke, har noe å si for hvordan du kan bruke funksjonen.

**Profftips:**

I oppgaven ba vi deg generere tilfeldige tall mellom 0 og 20 ved å bruke en kombinasjon av funksjonene `round()`, som runder av et tall til nærmeste heltall, og `runif()` som trekker en tilfeldige tall fra en uniform distribusjon (hvert tall har lik sannsynlighet for å forekomme). Men det er alltid flere måter å komme i mål på i R. Her er fire andre måter å få heltall mellom 0 og 20 på:

```{r}
as.integer(runif(10, 0, 20))
floor(runif(10, 0, 20))
ceiling(runif(10, 0, 20))
rbinom(10, 20, .5)
```

Bruk gjerne hjelpefunksjonen i R for å finne mer ut om funksjonene som er brukt her. Vi kan også bruke funksjonen `sample()` for å trekke tilfeldige tall mellom 0 og 20. Vi oppgir `0:20` som første argument og setter det andre argumentet til `10`. Vi får da ti heltall mellom 0 og 20. Ved å sette argumentet `replace` til `TRUE`, så trekker vi et utvalg med tilbakelegging, slik at ett tall kan trekkes mer enn én gang.

```{r}
sample(0:20, 10)
sample(0:20, 10, replace = TRUE)
```

Dette fungerer fint når vi bare skal ha ti siffer. Men hva skjer hvis vi skal ha 50 tall?

```{r}
sample(0:20, 50)
```

Vi får en feilmelding siden vi forsøker å trekke et utvalg som er større enn vektoren vi har gitt til funksjonen (vi har totalt 21 heltall som gis til `sample()`). Men hvis vi trekker et utvalg med tilbakelegging, så vil dette gå fint, siden ett tall da kan forekomme mer enn en gang.

```{r}
sample(0:20, 50, replace = TRUE)
```

### Oppgave 9: Likhet

1. Er uttrykket `nchar('riksrevisjonen')` **lik** 13?
2. Er uttrykket `-6 * 4 + 5` **større enn** `-3 * 8 - 4`?
3. Er summen av `c(TRUE, FALSE, TRUE)` **større enn** `2`
4. Er uttrykket `ceiling(2.2 * 4.7)` **større eller lik** uttrykket `floor(2.2 * 5.2)`

```{r}
nchar('riksrevisjonen') == 13
(-6 * 4 + 5) > (-3 * 8 - 4)
sum(c(TRUE, FALSE, TRUE)) > 2
ceiling(2.2*4.7) >= floor(2.2 * 5.2)
```

Summen av `c(TRUE, FALSE, TRUE)` er det samme som `1 + 0 + 1`. Resultatet i tredje deloppgave blir derfor `FALSE`.

`ceiling` runder _opp_ til nærmeste heltall, mens `floor` runder _ned_ til nærmeste heltall. Resultatet blir derfor `TRUE`.

### Oppgave 10: Logiske operatorer og betingelser

1. Hva er resultatet av `if (nchar('riksrevisjonen') > 5) TRUE else FALSE`?
2. Skriv kode som returerer `Sant` hvis uttrykket `abs(-20)` er **større enn** `0`
3. Skriv kode som tilordner `x` verdien `"Mindre enn 5"` hvis uttrykket `runif(1, 1, 10)` er **mindre enn** `5` og verdien `"Større enn 5"` hvis ikke. Kjør koden; hva er verdien av `x`?
4. Kjør koden på nytt. Er verdien den samme?

```{r}
if (nchar('riksrevisjonen') > 5) TRUE else FALSE
if (abs(-20) > 0) TRUE

set.seed(1984)
(x <- if (runif(1, 1, 10) < 5) 'Mindre enn 5' else 'Større enn 5')
(x <- if (runif(1, 1, 10) < 5) 'Mindre enn 5' else 'Større enn 5')
```

Resultatet blir ikke _nødvendigvis_ det samme fordi vi bruker en tilfeldig funksjon, `runif` som trekker et tilfeldig tall fra en uniform distribusjon. Merk at vi i løsningsforslaget har brukt `set.seed` for å sikre oss at vi i dette tilfellet får to forskjellige resultat når vi kjører koden to ganger.

### Oppgave 11: (S)apply

```{r, include = FALSE}
load("intro-til-r.RData")
```

Objektet nokeur skal være tilgjengelig i ditt arbeidmiljø. Objektet inneholder en liste med gjennomsnittverdien per måned for én euro i norske kroner etter år.

1. Hva er gjennomsnittet for hver vektor?
2. Hva er maksimal verdi for hver vektor?
3. Hva er minimal verdi for hver vektor?
4. Hva er maksimal verdi for hele datasettet?

```{r}
sapply(nokeur, mean)
sapply(nokeur, max)
sapply(nokeur, min)
```

For å få maksimal verdi for hele datasettet, kan vi bruke `max()` på vektoren vi fikk returnert på andre deloppgave.

```{r}
max(sapply(nokeur, max))
```

Et alternativ er å bruke `max()` på resultatet av `unlist()`. Siden vi har en liste med vektorer hvor alle er numeriske, vil `unlist()` gi oss en vektor med alle elementene fra alle listene:

```{r}
max(unlist(nokeur))
```
